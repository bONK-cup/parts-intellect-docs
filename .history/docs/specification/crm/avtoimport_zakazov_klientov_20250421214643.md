---
title: avtoimport_zakazov_klientov
createTime: 2025/04/21 21:02:30
---
# Автоимпорт заказов клиентов

Модуль **Автоимпорт заказов клиентов** позволяет автоматизировать создание заказов от клиентов с указанных почтовых ящиков. По созданным в программе правилам осуществляется поиск писем с файлами (**Заказов клиентов**) с их последующей загрузкой в программу.

Окно инструмента содержит блок **Правила автоматического импорта**, вкладки **Настройки** и **Журнал**.

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.288.png)

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.004.png) **Правила автоматического импорта**

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.289.png)

Позволяет создавать и редактировать правила автоматического импорта заказов.

Табличная часть блока настраивается индивидуально под каждого пользователя и содержит следующие колонки:

- **Новые ошибки** – колонка состояния загрузки. В случае, если при загрузке произошли ошибки и в **Журнале** **импорта** есть непрочитанные сообщения о них за последние 3 дня, в колонке отображается иконка ![ref36];

- **Название** – название правила автоматического импорта;

- **Активность** – признак активности правила. Автоматическая загрузка **Заказов клиентов** происходит только по активным правилам;

- **OID** – уникальный идентификатор правила в базе данных;

**Дата создания** -  дата создания правила;

- **Дата последнего изменения** – дата последнего изменения свойств правила.

Панель действий блока содержит команды для взаимодействия с правилами автоматического импорта заказов:

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.291.png)

- **Обновить** – позволяет обновить табличную часть правил;

- **Добавить** – позволяет добавить новое правило;

- **Сохранить** – позволяет сохранить правило;

- **Копировать** – позволяет скопировать выбранное правило;

- **Удалить** – позволяет удалить выбранное правило;

- **Создать bat-файл** – позволяет открыть окно для создания bat-файла запускающего автоматический импорт заказов;

- **Помощь** – позволяет открыть руководство пользователя по разделу.

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.006.png) **Настройки**

Вкладка предназначена для настройки правил загрузки **Заказов клиентов** и содержит следующие настройки:

- блок **Настройки подключения**:

   - **Активность** – определяет активность каждого правила;

   ::: note Замечание

   Автоматическая загрузка заказов клиентов происходит только по активным правилам.

   :::

   - **Тип источника** – выбор типа источника, по умолчанию доступен только Email;
   - **Источник** – учетная запись электронной почты, с которой будет происходить сбор заказов клиентов.
    
- блок **Настройки правил**:
   - **Электронная почта клиента** – адрес электронной почты клиента, с которого поступают письма с заказами;

   ::: note Замечание

   Для того, чтобы система осуществляла поиск писем только по определенной части адреса электронной почты (например, только по домену), необходимо заменить необязательные символы в адресе на символ \* ("звёздочка").

   :::

   - **Папка писем клиента** – в поле указывается папка почтового сервиса, в которой будет производиться поиск писем с заказами от клиентов для их дальнейшей загрузки в систему. При пустом значении поля поиск писем будет выполняться в папке "Входящие". Если письма от клиента находятся в какой-либо подпапке, необходимо указать полный путь на сервере электронной почты, начиная с корневой папки (без указания папки "Входящие"), учитывая разделители для разных почтовых серверов (вместо наименований Корневая папка, Подкаталог, Папка – используйте свои названия):
      - **Yandex**:  Корневая папка|Подкаталог|Папка писем клиента;
      - **GMail, Mail, Outlook**:  Корневая папка/Подкаталог/Папка писем клиента;
      - **Tradesoft**:  Корневая папка.Подкаталог.Папка писем клиента.

   ::: info Примечание

   Для почт Outlook и Tradesoft, если корневой папкой являются "Входящие", перед указанием пути к серверу требуется написать "INBOX" при этом папку "Входящие" указывать не нужно: INBOX/Подкаталог/Папка писем клиента.

   :::

   - **Тема письма** – тема письма от клиента. В данном поле присутствует возможность использовать символы \* и ?, позволяющие заменить любое количество символов и один символ в теме письма, соответственно. 

   ::: note Пример

   - текст "\*клиента" позволяет найти все письма, тема которых оканчивается словом "клиента";
   - текст "\*заказ" позволяет найти все письма, тема которых внутри содержит слово "заказ";
   - текст "Заказ" позволяет найти все письма, тема которых начинается со слова "Заказ";
   - текс "Заказ?" позволяет найти все письма, тема которых начинается со слова "Заказ" и содержит после этого слова только один символ, например: "Заказ1".

   :::

   - **Вложения** – наименование вложения в письме клиента, в котором содержится заказ. В данном поле присутствует возможность использовать символы \* и ?, позволяющие заменить любое количество символов и один символ в наименовании вложения.

   ::: warning Внимание!

   Для корректной идентификации письма должны располагаться в корневой папке "Входящие" почтового ящика, поиск по подпапкам не производится.

   :::

   - **Номер листа** – номер листа (таблицы), данные с которого необходимо импортировать в систему. Порядковые номера таблиц (листов) определяются в соответствии с их названиями, с сортировкой по алфавиту.

- блок **Обработка**:
   - **Распаковать из ZIP-архива** – позволяет включить возможность распаковки архива, если вложение является zip­архивом. 
      - **Файлы в архиве** – позволяет указать название файла в архиве, который необходимо загрузить в программу. Поле поддерживает возможность использовать символы \* и ?;

      ::: warning Внимание!

      Если по заданной маске будет найдено несколько вложений или файлов в архиве, все найденные файлы будут переданы в обработку.

      :::

   - **Внешняя обработка** - позволяет выбрать один из файлов внешней обработки, которые представляют собой скрипты, написанные на языке VBScript. Доступны следующие обработки исходных файлов:
      - **ConvertToCsv.vbs** – конвертация в формат .csv. Может понадобиться для корректной загрузки данных, так как формат Excel может автоматически преобразовывать некоторые значения в некорректные. Например, в ячейках могут теряться первичные нули чисел;
      - **ConvertToXlsx.vbs** – конвертация в формат .xlsx. Может понадобиться для корректной загрузки данных в случаях, когда исходный файл с расширением .xls\* не может быть распознан системой;
      - **UnArch.vbs** – распаковка архива. Может использоваться в случаях, когда прайс-листы присылают в архиве. Распаковка универсальная, может разархивировать любой формат.
      - **UnArch\_and\_ConvertToCsv.vbs** и **UnArch\_and\_ConvertToXlsx.vbs** – распаковка и конвертирование. Может использоваться в случаях, когда прайс-листы необходимо извлечь из архива, а также выполнить конвертацию в один из доступных форматов.

   ::: info Примечание

   Для использования обработчиков с распаковкой и конвертацией файлов обязательно требуется установленное на компьютере ПО 7-zip и Microsoft Excel 2007 и выше.

   :::

- блок **Настройки импорта**:
   - **Разметка для импорта** – выбор разметки из сохраненных при **Импорте** заказов клиента – **С проценкой**;

   ::: note Замечание

   Для выбора доступны не удаленные разметки, созданные пользователем или прочие, созданные как **Общая**. Отбираются только разметки, в которых указан **Клиент**.

   :::

   - **Клиент из разметк**и – клиент, который будет автоматически подставляться в созданный документ;

   ::: note Замечание

   Значение **Клиента** берется со вкладки **Настройки** из разметки для импорта и редактируется только там.

   :::

   - **Наша фирма** – выбор из справочника **Нашей фирмы**, которая будет установлена в соответствующее поле в созданном документе;
   - **Место выдачи** – выбор из справочника **Склада/Торговой точки**, которая будет установлена в соответствующее поле в созданном документе;
   - **Ответственный** – выбор сотрудника из списка пользователей, созданных в разделе **Управление** ► **Настройки программы**, вкладка **Пользователи**. Выбранному сотруднику на указанный в карточке пользователя email будет отправляться письмо, содержащее информацию о нераспознанных позициях, с указанием причин, по которым позиции были пропущены, а также отчет о результатах импорта каждого файла (с указанием наименования файла лога);

   ::: note Замечание

   Ответственный будет являться автором документа **Заказ клиента**. Для корректного создания документа ответственному должны быть доступны, выбранные в правиле загрузки: **Клиент**, **Наша фирма** и **Место выдачи**.

   :::

   - **Действие с документом** – выбор действия с найденным **Заказом клиента**: **Сохранить** или **Сохранить и провести**.

- блок **Обслуживание**:
   - **Управление письмами** – содержит кнопку **Управление** для просмотра писем, соответствующих заданному правилу (адресу почты клиента, теме и вложению). Откроется окно **Управление письмами**. Данный инструмент необходим для отладки заданных правил, чтобы убедиться, что письма находятся корректно.

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.292.png)

::: warning Внимание!

Для каждого клиента, а также файлов разного вида и формата необходимо создавать отдельное правило на загрузку.

:::

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.008.png) **Журнал**

На вкладке **Журнал** по каждому правилу фиксируется дата и время этапов выполнения задачи по загрузке заказов клиентов с почты. При открытии журнала все сообщения об ошибках по выбранному правилу помечаются прочитанными.

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.293.png)

Журнал состоит из двух частей:

- **Таблица с информацией о процессах и сервисной информацией**. Таблица содержит следующие колонки:

::: note Замечание

Содержит два типа сообщений:
- **сервисные сообщения** – информация об изменении настроек правила;
- **информация о процессах** – общая информация о каждом запуске процесса автоматического импорта заказов клиентов.

:::

- **Дата начала** и **Дата окончания** – дата и время запуска и окончания процесса автоматического импорта заказов клиентов, или дата и время изменения настроек правила, если сообщение сервисное;
- **Обработка** – перечисление примененных обработок из настроек правила (блок **Обработка**). Если сообщение сервисное, то поле пустое;
- **Применение** – отображается текст **Автоимпорт заказов клиентов**. Если сообщение сервисное, то поле пустое;
- **Источник** – наименование источника данных из настроек правила. Если сообщение сервисное, то поле пустое;
- **Компьютер** – имя компьютера, с которого был осуществлен запуск процесса автоматического импорта заказов клиентов, или имя компьютера, с которого было осуществлено изменение настроек правила, если сообщение сервисное;
- **Пользователь** – логин пользователя, под которым был осуществлен запуск процесса автоматического импорта заказов клиентов, или логин пользователя, изменившего настройки правила, если сообщение сервисное;
- **Итог** – результат выполнения операции. Имеет следующие значения:
   1  ![ref37] **Завершен и требует внимания** – отображается, если при импорте были выявлены нераспознанные, исключенные по количеству или стоимости позиции;
   1  ![ref36] **Ошибка** – отображается, если в таблице ниже (детализация процесса) содержится хотя бы одна запись об ошибке;
   1  ![ref38] **Успешное завершение** – отображается, если в таблице ниже (детализация процесса) содержится хотя бы одна запись об успешном завершении и не содержится ошибок;
   1  ![ref39] **Настройки изменены** – отображается для сервисных сообщений;
   1  ![ref40] **Нет данных** – состояние присваивается записи, если после выполнения любого из этапов процесса не были получены данные, подходящие под настройки правила: в источнике данных не найдены письма.
   1  **Таблица с детализацией процесса**. Таблица содержит следующие колонки:

      |||
      | :- | :- |
      |![ref11]|Содержит два типа сообщений:•  **сервисные сообщения** – информация об изменении настроек правила;
•  **информация о процессах** – общая информация о каждом запуске процесса автоматического импорта заказов клиентов.|
      |||

1  колонка, содержащая иконку состояния процесса. Доступные значения:
   1  ![ref37]  – процесс завершен с замечаниями;
   1  ![ref36] – ошибка выполнения процесса;
   1  ![ref38] – успешное завершение выполнения процесса;
   1  ![ref41] – нет данных.
      1  **Начало процесса** и **Окончание процесса** – дата и время запуска и окончания отдельного процесса автоматического импорта или изменения настроек правила;
      1  **Источник файлов –** наименование источника данных из настроек правила (поле **Источник**);
      1  **Информация об источнике –** информация об источнике (тема и дата, время письма) откуда был взят файл;
      1  **Загруженные файлы** – наименование полученных файлов из источника данных, подходящих под настройки правила. Если в источнике данных не найдено файлов, отображается текст: "*Нет данных*". Если во время получения файлов из источника данных произошла ошибка, то отображается сообщение об ошибке;
      1  **Файлы после обработки** – наименование обработанных файлов из источника данных, подходящих под настройки правила. Если в источнике данных не найдено файлов, отображается текст: "*Нет данных*". Если во время получения файлов из источника данных произошла ошибка, то отображается сообщение об ошибке;
      1  **Результаты** – информация о результатах выполнения правила импорта. Если импорт завершен успешно, то отображается информация о созданном документе, датой и временем создания, а также общая информация о результатах импорта. Аналогичная информация, а также путь к файлу лога отображаются в созданном документе **Заказ клиента**, в поле **Комментарий**. Если в процессе импорта произошла ошибка, то отображается сообщение об ошибке. Если в источнике данных не найдено файлов, то поле пустое.

![](../../assets/specification/Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.299.png)