import{_ as u,c as i,d as t,e as n,a,b as r,w as s,r as e,o as d}from"./app-CUu1n7_5.js";const p={};function b(v,l){const o=e("RouteLink");return d(),i("div",null,[l[7]||(l[7]=t("p",null,[n("При актуализации подсостояний у позиций "),t("strong",null,"Заказа поставщику"),n(" с информацией о текущих статусах от поставщиков используется особый алгоритм сопоставления данных в программе и данных от поставщика.")],-1)),l[8]||(l[8]=t("div",{class:"hint-container note"},[t("p",{class:"hint-container-title"},"Замечание"),t("p",null,"Алгоритм описан для общего случая и применяется как при актуализации с помощью файла от поставщика, так и в случае использования сервиса актуализация.")],-1)),t("ul",null,[l[6]||(l[6]=a("<li><p>На входе алгоритма имеется набор транзакций из программы (которым требуется обновить подсостояния) и набор позиций из источника (которыми обновляются подсостояния, из файла либо сервиса Веб-заказ). В дополнение передается &quot;ключ&quot;, по которому осуществляется состыковка позиций (свойства позиции ЗП, либо один из референсов);</p></li><li><p>Затем в зависимости от источника обновления:</p><ul><li><p>Если через импорт файла, то в файле по &quot;ключу&quot; отбираются коллекции записей с идентичным ключом. Затем по каждой коллекции (по ключу) формируется коллекция транзакций из программы с таким же &quot;ключом&quot;;</p></li><li><p>Если через сервис, то наоборот: формируется коллекция позиций в программе по &quot;ключу&quot;, а затем каждый уникальный ключ направляется в сервис Веб-заказ;</p></li></ul></li><li><p>Особенность подбора коллекций из программы. Программа по &quot;ключу&quot; подбирает как транзакции в состоянии &quot;заказ поставщику&quot;, так и, если анализирует транзакции в других состояниях, но с тем же &quot;ключом&quot;. Программа просматривает историю транзакций назад до ближайшего момента в состоянии &quot;заказ поставщику&quot;. Затем из ответа от сервиса либо файла отфильтровывает позиции с таким же &quot;ключом&quot; и подсостоянием (с учетом количества). А затем применяется алгоритм, описанный ниже;</p></li><li><p>Если &quot;ключ&quot; коллекции найден только в одном источнике, то эта коллекция не обновляется;</p></li><li><p>Если статус от поставщика не распознан (нет соответствия с парой &quot;Состояние-Подсостояние&quot; в карточке поставщика на вкладке Веб-заказ), то позиция источника игнорируется;</p></li>",5)),t("li",null,[l[5]||(l[5]=t("p",null,"Далее идет перебор коллекций:",-1)),t("ul",null,[t("li",null,[t("p",null,[l[1]||(l[1]=n("Статус из источника преобразуется в подсостояние программы с помощью справочника из ")),r(o,{to:"/work/postavshchiki/redaktirovanie_postavshchikov.html"},{default:s(()=>l[0]||(l[0]=[n("карточки поставщика")])),_:1,__:[0]}),l[2]||(l[2]=n(";"))])]),l[3]||(l[3]=t("li",null,[t("p",null,'Затем берутся две коллекции (из Parts.Intellect и источника) с идентичным "ключом" и начинается сверка и обновление;')],-1)),l[4]||(l[4]=t("li",null,[t("p",null,'Ошибочные ситуации выводятся в лог-файл. Не нашлось соответствие текста статуса от поставщика и подсостояния "заказ поставщику" в карточке поставщика и т.д.')],-1))])])]),l[9]||(l[9]=t("table",null,[t("thead",null,[t("tr",null,[t("th",null,"Позиций в коллекции из программы (Parts.Intellect)"),t("th",null,"Позиций в коллекции из источника (файл либо сервис Веб-заказ)"),t("th",null,"Количество штук товара в коллекции из Parts.Intellect сравниваем с источником"),t("th",null,"Действие")])]),t("tbody",null,[t("tr",null,[t("td",{rowspan:"3"},"1"),t("td",{rowspan:"3"},"1"),t("td",null,[t("b",null,"=")]),t("td",{valign:"top"},"Обновляется статус, если он сменился")]),t("tr",null,[t("td",null,[t("b",null,">")]),t("td",{valign:"top"},"Дробится позиция в программе и устанавливается новый статус")]),t("tr",null,[t("td",null,[t("b",null,"<")]),t("td",{valign:"top"},"Обновляется статус на количество из программы")]),t("tr",null,[t("td",{rowspan:"3"},"N"),t("td",{rowspan:"3"},"1"),t("td",null,[t("b",null,"=")]),t("td",{valign:"top"},"Всем позициям программы устанавливается статус из источника")]),t("tr",null,[t("td",null,[t("b",null,">")]),t("td",{valign:"top"},"Позициям из программы устанавливается новый статус, начиная с позиций с самой старой датой обновления подсостояния")]),t("tr",null,[t("td",null,[t("b",null,"<")]),t("td",{valign:"top"},"Всем позициям программы устанавливается статус из источника")]),t("tr",null,[t("td",{rowspan:"3"},"1"),t("td",{rowspan:"3"},"N"),t("td",null,[t("b",null,"=")]),t("td",{valign:"top"},"Дробится позиция в программе и устанавливаются новые подсостояния")]),t("tr",null,[t("td",null,[t("b",null,">")]),t("td",{valign:"top"},"Дробится позиция в программе и устанавливаются новые подсостояния. Остаток позиций программе имеет прежнее подсостояние.")]),t("tr",null,[t("td",null,[t("b",null,"<")]),t("td",{valign:"top"},"Позициям из программы устанавливается новый статус. Сортировка позиций источника по порядку, в котором они следуют в источнике.")]),t("tr",null,[t("td",{rowspan:"3"},"N"),t("td",{rowspan:"3"},"M"),t("td",null,[t("b",null,"=")]),t("td",{valign:"top"},[n("1. Определяется разница, задается соответствие программа-источник. Позиции коллекций, чьи статусы совпадают, уходят из алгоритма с учетом их остатка. На выходе позиции программы и Источника, которые необходимо состыковать. А остальные позиции не изменили статус и не требуют актуализации."),t("br"),n("2. Присваиваются статусы с минимальным количеством раздробленных позиций программы."),t("br"),n("2.1 Сразу применяются статусы с одинаковым количеством. 1-1, 2-2, 3-3,..."),t("br"),n("2.2 Оставшиеся позиции обновляются по порядку. Сортировка по дате обновления подсостояния, от старых к новым.")])]),t("tr",null,[t("td",null,[t("b",null,">")]),t("td",{valign:"top"},[n("1. Определяется разница, задается соответствие программа-источник. Позиции коллекций, чьи статусы совпадают, уходят из алгоритма с учетом их остатка. На выходе позиции программы и Источника, которые необходимо состыковать. А остальные позиции не изменили статус и не требуют актуализации."),t("br"),n("2. Присваиваются статусы с минимальным количеством раздробленных позиций программы."),t("br"),n("2.1 Сразу применяются статусы с одинаковым количеством. 1-1, 2-2, 3-3,..."),t("br"),n("2.2 Оставшиеся позиции обновляются по порядку. Сортировка по дате обновления подсостояния, от старых к новым."),t("br"),n("3. Алгоритм заканчивается, когда коллекция из файла полностью потрачена.")])]),t("tr",null,[t("td",null,[t("b",null,"<")]),t("td",{valign:"top"},[n("1. Определяется разница, задается соответствие программа-источник. Позиции коллекций, чьи статусы совпадают, уходят из алгоритма с учетом их остатка. На выходе позиции программы и Источника, которые необходимо состыковать. А остальные позиции не изменили статус и не требуют актуализации."),t("br"),n("2. Присваиваются статусы с минимальным количеством раздробленных позиций программы."),t("br"),n("2.1 Сразу применяются статусы с одинаковым количеством. 1-1, 2-2, 3-3,..."),t("br"),n("2.2 Оставшиеся позиции обновляются по порядку. Сортировка по дате обновления подсостояния, от старых к новым."),t("br"),n("3. Алгоритм заканчивается, когда коллекция из программы полностью потрачена.")])])])],-1))])}const k=u(p,[["render",b]]),q=JSON.parse('{"path":"/work/postavshchiki/sinkhronizatsiya_statusov/algoritm_aktualizatsii_podsostoyanij.html","title":"Алгоритм актуализации подсостояний у позиций заказов поставщикам","lang":"en-US","frontmatter":{"title":"Алгоритм актуализации подсостояний у позиций заказов поставщикам","createTime":"2025/05/30 22:02:20"},"headers":[],"readingTime":{"minutes":2.9,"words":869},"git":{"updatedTime":1748679750000,"contributors":[{"name":"a.lutoshkin","username":"","email":"a.lutoshkin@tradesoft.ru","commits":1,"avatar":"https://gravatar.com/avatar/605ee9d365e3a6380f8e9c71f9269ee5373d537aebefbece4e023cac396dfc8d?d=retro"}]},"filePathRelative":"work/postavshchiki/sinkhronizatsiya_statusov/algoritm_aktualizatsii_podsostoyanij.md","categoryList":[{"id":"67e92c","sort":10000,"name":"work"},{"id":"f92cdc","sort":10082,"name":"postavshchiki"},{"id":"453e8f","sort":10100,"name":"sinkhronizatsiya_statusov"}]}');export{k as comp,q as data};
