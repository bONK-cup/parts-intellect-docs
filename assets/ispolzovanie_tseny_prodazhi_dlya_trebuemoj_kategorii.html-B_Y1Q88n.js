import{_ as t,c as i,a as r,o as a}from"./app-CUu1n7_5.js";const s={};function o(n,e){return a(),i("div",null,e[0]||(e[0]=[r('<p>Иногда в печатных бланках возникает необходимость помимо фактической цены продажи из документа иметь цену продажи от требуемой категории клиентов. Для сравнения, аналитики, вывода скидки/разницы и т.д.</p><p>Например, печатая документы по РН для VIP-клиента, использовать цены на эти товары для категории &quot;Розница&quot; и вывести сумму скидки для VIP-клиента. Для этого необходимо:</p><p><strong>»</strong> В печатном бланке по РН для события <strong>Начало построения</strong> страницы добавить следующий код:</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>/\\*0. Формирование массива с позициями РН\\*/ List&lt;Tradesoft.Autovision.Ware&gt; wares = new List&lt;Tradesoft.Autovision.Ware&gt;(); for(int i = 0; i &lt; CurrentObject\\_Items.Count; i++) // Для каждого товара в документе РН { wares.Add( ((Tradesoft.Autovision.Ware)(StiReport.ChangeType(CurrentObject\\_Items.GetData(&quot;Ware!&quot;, i), typeof(Tradesoft.Autovision.Ware), true)))); } /\\* Конец формирование массива с позициями РН \\*/   /\\*1. Подбор базовой цены продажи из прайс-листа на Расширенной СЦО\\*/ \\_pricesSaleFromCommonPricelist = Tradesoft.Autovision.Helpers.StimulHelper.GetPriceSaleFromCommonPricelist(wares, CurrentObject.Currency\\_); /\\*Конец подбора базовой цены продажи из прайс-листа на Расширенной СЦО\\*/ /\\*2. Подбор цены продажи из Проценки для выбранной категории\\*/ Tradesoft.Autovision.ClientCategory roznica = CurrentObject.Contragent\\_.Session.GetObjectByKey&lt;Tradesoft.Autovision.ClientCategory&gt;(2); // Указывается категория, для которой вычислить цены продаж. По Oid, в данном случае у Розницы Oid=2 \\_pricesSaleFromMonetary = Tradesoft.Autovision.Helpers.StimulHelper.GetPriceSaleFromMonetary(wares, roznica,CurrentObject.Currency\\_); /\\*Конец подбора цены продажи из Проценки для выбранной категории\\*/</span></span></code></pre></div><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>Обратите вниание, что на практике имеет смысл обязательно вставлять нулевую секцию, а далее по необходимости: первую или вторую секцию (формировать только одну цену продажи). Например, если требуется оперировать только <strong>Базовой ценой продажи</strong>, то необходимо вставить код из секции &quot;<em>0</em>&quot; и &quot;<em>1</em>&quot;, а код из секции &quot;<em>2</em>&quot; не вставлять. Это сэкономит ресурсы компьютера и ускорит построение шаблона.</p></div><p><strong>»</strong> Затем в шаблоне бланка для <em><strong>CurrentObject_Items</strong></em> используются вычисленные цены с помощью следующего кода:</p><p><code>{\\_pricesSaleFromMonetary.GetValue(CurrentObject\\_Items.Ware\\_.Oid) != 0? \\_pricesSaleFromMonetary.GetValue(CurrentObject\\_Items.Ware\\_.Oid) : CurrentObject\\_Items.DiscountPrice}</code></p><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>В этом примере используется коллекция с ценами из проценки (<em>pricesSaleFromMonetary.GetValue</em>). По аналогии можно использовать получение базовых цен продажи из прайс-листа на <strong>Расширенной СЦО</strong> (<em>pricesSaleFromCommonPricelist.GetValue</em>). Код проверяет, если цена не пришла (равна 0), то используется цена из документа РН.</p></div><p><strong>»</strong> Также необходимо подключить следующие библиотеки, прописав следующий текст в коде бланка:</p><div class="language-" data-highlighter="shiki" data-ext="" style="--shiki-light:#393a34;--shiki-dark:#dbd7caee;--shiki-light-bg:#ffffff;--shiki-dark-bg:#121212;"><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span>using System.Collections.Generic; using Tradesoft.Autovision.Helpers; и определить коллекции для вычисления цен: //Цены продажи из прайс-листа (только для расширенной СЦО) StimulDictinary&lt;int, decimal&gt; \\_pricesSaleFromCommonPricelist; //Цены продажи из проценки StimulDictinary&lt;int, decimal&gt; \\_pricesSaleFromMonetary;</span></span></code></pre></div>',10)]))}const l=t(s,[["render",o]]),d=JSON.parse('{"path":"/work/pechatnye_formy/ispolzovanie_tseny_prodazhi_dlya_trebuemoj_kategorii.html","title":"Использование цены продажи для требуемой категории в печатных бланках РН","lang":"en-US","frontmatter":{"title":"Использование цены продажи для требуемой категории в печатных бланках РН","createTime":"2025/06/13 01:09:52"},"headers":[],"readingTime":{"minutes":1.28,"words":385},"git":{"updatedTime":1749768073000,"contributors":[{"name":"a.lutoshkin","username":"","email":"a.lutoshkin@tradesoft.ru","commits":1,"avatar":"https://gravatar.com/avatar/605ee9d365e3a6380f8e9c71f9269ee5373d537aebefbece4e023cac396dfc8d?d=retro"}]},"filePathRelative":"work/pechatnye_formy/ispolzovanie_tseny_prodazhi_dlya_trebuemoj_kategorii.md","categoryList":[{"id":"67e92c","sort":10000,"name":"work"},{"id":"5aa880","sort":10085,"name":"pechatnye_formy"}]}');export{l as comp,d as data};
