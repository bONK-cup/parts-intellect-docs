import{_ as o,a as s}from"./008-BK48VWhW.js";import{_ as r}from"./009-B_xeZwXD.js";import{_ as n}from"./010-C_sEQWkL.js";import{_ as i}from"./011-BzP10_Dy.js";import{_ as p}from"./012-CnJZn6pa.js";import{_ as l,c as g,a,o as e}from"./app-CUu1n7_5.js";const u="/parts-intellect-docs/assets/272-DRX-eqMQ.png",c="/parts-intellect-docs/assets/273-B9LW8GPP.png",m={};function v(q,t){return e(),g("div",null,t[0]||(t[0]=[a('<p>Для создания правила загрузки и обновления прайс-листа выполните следующий действия:</p><p><strong>»</strong> В Главном меню выберите раздел <strong>Товары и цены ► Действия с прайс-листами ► Автоимпорт прайс-листов</strong>. Откроется окно <strong>Автоимпорта прайс-листов</strong>.</p><p><img src="'+u+'" alt=""></p><p><img src="'+o+'" alt=""> <strong>Правила автоматического импорта</strong></p><p>Блок содержит список правил для автоматического импорта прайс-листов. Создайте новое правило Путем нажатия кнопки <strong>Добавить</strong> на панели действий блока, либо выберете существующее правило.</p><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>Если ранее правила не создавались, то при открытии раздела сразу будет создано правило для настройки с именем <strong>Новое правило</strong>.</p></div><p><img src="'+s+'" alt=""> <strong>Настройки</strong></p><p>В блоке заполните следующие параметры:</p><ul><li><strong>Активность</strong> – определяет активность каждого правила;</li></ul><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>Автоматическая загрузка и обновление прайс-листов происходит только по активным правилам.</p></div><ul><li><p><strong>Тип источника *</strong> – Email;</p></li><li><p><strong>Источник *</strong> – учетная запись электронной почты, с которой будет происходить сбор прайс-листов.</p></li></ul><p><img src="'+r+'" alt=""> <strong>Настройка правил</strong></p><p>В блоке заполните следующие параметры:</p><p>Для типа источника <strong>Email</strong>:</p><ul><li><strong>Электронная почта поставщика *</strong> – адрес электронной почты поставщика, с которого поступают письма с прайс-листами;</li></ul><div class="hint-container note"><p class="hint-container-title">Замечание</p><p>Для того, чтобы система осуществляла поиск писем только по определенной части адреса электронной почты (например, только по домену), необходимо заменить необязательные символы в адресе на символ <strong>*</strong> (&quot;звёздочка&quot;).</p></div><ul><li><p><strong>Папка писем поставщика</strong> – в поле указывается папка почтового сервиса, в которой будет производиться поиск писем с прайс-листами от поставщика для их дальнейшей загрузки в систему. При пустом значении поля, поиск писем будет выполняться в папке &quot;Входящие&quot;. Если письма от поставщика находятся в какой-либо подпапке, необходимо указать полный путь на сервере электронной почты, начиная с корневой папки (без указания папки &quot;Входящие&quot;), учитывая разделители для разных почтовых серверов (вместо наименований Корневая папка, Подкаталог, Папка используйте свои названия):</p><ul><li><p><strong>Yandex</strong>:  Корневая папка|Подкаталог|Папка писем поставщика;</p></li><li><p><strong>GMail, Mail, Outlook</strong>:  Корневая папка/Подкаталог/Папка писем поставщика;</p></li><li><p><strong>Tradesoft</strong>:  Корневая папка.Подкаталог.Папка писем поставщика.</p></li></ul></li></ul><div class="hint-container warning"><p class="hint-container-title">Внимание!</p><p>Для почт Outlook и Tradesoft, если корневой папкой являются &quot;Входящие&quot;, перед указанием пути к серверу требуется написать &quot;INBOX&quot; при этом папку &quot;Входящие&quot; указывать не нужно: INBOX/Подкаталог/Папка писем поставщика.</p></div><ul><li><p><strong>Тема письма</strong> – тема письма от поставщика. В данном поле присутствует возможность использовать символы * и ?, позволяющие заменить любое количество символов и один символ в теме письма, соответственно. Например:</p><ul><li>текст &quot;*остатки&quot; позволяет найти все письма, тема которых оканчивается словом &quot;остатки&quot;;</li><li>текст &quot;*прайс*&quot; позволяет найти все письма, тема которых внутри содержит слово &quot;прайс&quot;;</li><li>текст &quot;Прайс*&quot; позволяет найти все письма, тема которых начинается со слова &quot;Прайс&quot;;</li><li>текст &quot;Прайс?&quot; позволяет найти все письма, тема которых начинается со слова &quot;Прайс&quot; и содержит после этого слова только один символ, например, &quot;Прайс1&quot;.</li></ul></li><li><p><strong>Вложения</strong> – наименование вложения в письме поставщика, в котором содержится прайс-лист. Поле аналогично предыдущему и поддерживает возможность использовать символы * и ?.</p></li></ul><div class="hint-container warning"><p class="hint-container-title">Внимание!</p><p>Для корректной идентификации письма должны располагаться в корневой папке &quot;Входящие&quot; почтового ящика, поиск по подпапкам не производится.</p></div><p>Для типа источника <strong>Ftp</strong>:</p><ul><li><p><strong>Путь до файла на сервере</strong> – полный путь к файлу на FTP-сервере с указанием имени файла. Имя сервера указывать не надо. В данном поле присутствует возможность использовать символы * и ?, позволяющие заменить любое количество символов и один символ в названии файла, соответственно. Например:</p><ul><li><p>текст &quot;/price/*price.csv&quot; позволяет найти все файлы на FTP-сервере в каталоге price, наименование которых оканчивается словом &quot;price.csv&quot;;</p></li><li><p>текст &quot;/*price*&quot; позволяет найти все файлы в корневом каталоге FTP-сервера, наименование которых внутри содержит слово &quot;price&quot;;</p></li><li><p>текст &quot;/price?&quot; позволяет найти все файлы в корневом каталоге FTP сервера, наименование которых начинается со слова &quot;price&quot; и содержит после этого слова только один символ, например, &quot;price 1&quot;.</p></li></ul></li></ul><p><img src="'+n+'" alt=""> <strong>Обработка</strong></p><p>В блоке указывается, какой прайс-лист необходимо извлекать из архива, а также дополнительные обработчики:</p><ul><li>Включите опцию <strong>Распаковать из ZIP-архива</strong>, если вложение является zip-­архивом. Укажите название файла в архиве, который необходимо загрузить в программу. Поле аналогично полю <strong>Вложение</strong> и поддерживает возможность использовать символы * и ?;</li></ul><div class="hint-container warning"><p class="hint-container-title">Внимание!</p><p>Если по заданной маске будет найдено несколько вложений или файлов в архиве, все найденные файлы будут переданы в обработку.</p></div><ul><li><p><strong>Внешняя обработка</strong> в одноименном поле присутствует возможность выбрать один из файлов внешней обработки, которые представляют собой скрипты, написанные на языке VBScript. Доступны следующие обработки исходных файлов:</p><ul><li><p><strong>ConvertToCsv.vbs</strong> – конвертация в формат .csv. Может понадобиться для корректной загрузки данных, так как формат Excel может автоматически преобразовывать некоторые значения в некорректные. Например, в ячейках могут теряться первичные нули чисел;</p></li><li><p><strong>ConvertToXlsx.vbs</strong> – конвертация в формат .xlsx. Может понадобиться для корректной загрузки данных в случаях, когда исходный файл с расширением .xls* не может быть распознан системой;</p></li><li><p><strong>UnArch.vbs</strong> – распаковка архива. Может использоваться в случаях, когда прайс-листы присылают в архиве. Распаковка универсальная, может разархивировать любой формат;</p></li><li><p><strong>UnArch_and_ConvertToCsv.vbs</strong> и <strong>UnArch_and_ConvertToXlsx.vbs</strong> – распаковка и конвертирование. Может использоваться в случаях, когда прайс-листы необходимо извлечь из архива, а также выполнить конвертацию в один из доступных форматов.</p></li></ul></li></ul><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>Для использования обработчиков с распаковкой и конвертацией файлов обязательно требуется установленное на компьютере ПО 7-zip и Microsoft Excel 2007 и выше.</p></div><p><img src="'+i+'" alt=""> <strong>Настройки обновления</strong></p><p>В блоке заполните следующие параметры:</p><ul><li><p><strong>Номер листа</strong> – номер таблиц (листа), данные с которого необходимо импортировать в систему. Порядковые номера таблиц (листов) определяются в соответствии с их названиями, с сортировкой по алфавиту;</p></li><li><p><strong>Прайс-лист</strong> – прайс-лист поставщика в программе, подлежащий обновлению;</p></li></ul><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>Прайс-лист поставщика предварительно должен быть загружен в программу вручную.</p></div><ul><li><p><strong>Разметка для импорта</strong> – разметка для импорта прайс-листа. Добавляется при ручной загрузке файла в систему;</p></li><li><p><strong>Диапазон записей: начало</strong> и <strong>Диапазон записей: конец</strong> – диапазон строк, содержащих данные для загрузки. Например, если в прайс-листе присутствует заголовок таблицы в первой строке, то ее нужно пропустить, диапазон в этом случае: 1 – до конца файла;</p></li><li><p><strong>Идентификация позиций</strong> – свойства для идентификации позиций при их обновлении. Доступны Код – Производитель и Внутренний код.</p></li></ul><div class="hint-container info"><p class="hint-container-title">Примечание</p><p>В случае использования в качестве идентификатора свойства <strong>Внутренний код</strong>, оно должно быть заполнено в карточке товара.</p></div><ul><li><p><strong>Режим импорта</strong> – режим обновления позиций в прайс-листе. Доступны следующие варианты загрузки:</p><ul><li><p><strong>Замена (старые позиции удаляются)</strong> – импортируемый прайс-лист заменит своим содержанием текущий прайс-лист;</p></li><li><p><strong>Обновление только существующих позиций</strong> – в прайс-листе будут обновлены записи согласно данным из импортируемого прайс-листа;</p></li><li><p><strong>Обновление существующих позиций и добавление новых</strong> – в прайс-листе будут обновлены и добавлены новые записи согласно данным из импортируемого прайс-листа;</p></li></ul></li><li><p><strong>Новые производители</strong> – действие для новых производителей, встретившихся в прайс-листе поставщика:</p><ul><li><p><strong>Добавить новых производителей</strong> – все новые производители будут добавлены в справочник <strong>Производители</strong>;</p></li><li><p><strong>Не загружать новых производителей</strong> – все новые производители будут проигнорированы;</p></li><li><p><strong>Спросить пользователя</strong> – откроется диалоговое окно для выбора действия с новым производителем.</p></li></ul></li></ul><p><img src="'+p+'" alt=""> <strong>Обслуживание</strong></p><p>В блоке нажмите кнопку <strong>Управление</strong> в поле <strong>Управление письмами</strong> для просмотра писем, соответствующих заданному правилу (адресу поставщика, теме и вложению). Откроется окно <strong>Управления письмами</strong>. Данный инструмент необходим для отладки заданных правил, чтобы убедиться, что письма находятся корректно, доступен только для типа источника Email.</p><p><img src="'+c+'" alt=""></p><p><strong>»</strong> Включите признак <strong>Обработать</strong>, в табличной части, для писем, вложения которых требуется загрузить в программу. По умолчанию признак включен у необработанных писем, вложения которых ранее не загружали. В случае включения признака у ранее обработанных писем, произойдет повторная загрузка их вложений в программу.</p><p><strong>»</strong> Отключите признак <strong>Обработать</strong> для писем, вложения которых не требуется загружать в программу.</p><p><strong>»</strong> Нажмите кнопку <strong>Выбрать</strong>. Все отмеченные письма помещаются в очередь на обработку и будут обработаны при следующем запуске bat-файла автоматического импорта.</p><p><strong>»</strong> Нажмите кнопку <strong>Сохранить</strong>, на панели действий блока <strong>Правила автоматического импорта</strong>, для сохранения внесенных изменений.</p><p>После настройки правил импорта перейдите к настройкам исполняемого файла загрузки и обновления прайс-листов.</p>',43)]))}const T=l(m,[["render",v]]),x=JSON.parse('{"path":"/work/prajsy_postavshchikov/zagruzka/avtoimport/sozdanie_pravila_avtoimporta_prajs-listov.html","title":"Создание правила автоимпорта прайс-листов","lang":"en-US","frontmatter":{"title":"Создание правила автоимпорта прайс-листов","createTime":"2025/05/16 21:51:40"},"headers":[],"readingTime":{"minutes":3.9,"words":1169},"git":{"updatedTime":1747905440000,"contributors":[{"name":"bONK-cup","username":"bONK-cup","email":"kokosik260302@gmail.com","commits":3,"avatar":"https://avatars.githubusercontent.com/bONK-cup?v=4","url":"https://github.com/bONK-cup"}]},"filePathRelative":"work/prajsy_postavshchikov/zagruzka/avtoimport/sozdanie_pravila_avtoimporta_prajs-listov.md","categoryList":[{"id":"67e92c","sort":10000,"name":"work"},{"id":"f311a7","sort":10081,"name":"prajsy_postavshchikov"},{"id":"e66f6e","sort":10102,"name":"zagruzka"},{"id":"dc8856","sort":10128,"name":"avtoimport"}]}');export{T as comp,x as data};
