---
title: avtoimport_prihodnyh_dokumentov
createTime: 2025/04/23 14:56:27
---
# Автоимпорт приходных документов

**Автоимпорт приходных документов** позволяет автоматизировать создание приходных документов от поставщиков с указанных почтовых ящиков. По созданным в программе правилам осуществляется поиск писем с файлами (приходными документами) с их последующей загрузкой в программу.

Модуль **Автоимпорт** обладает следующими возможностями:

подбор позиций для загрузки в программу: данные из полученного от поставщика файла соотносятся с заданными настройками в разделе **Автоимпорт приходных документов** и ранее созданными **Заказами поставщиков**;

::: note Замечание

Осуществляется проверка соответствия позиций в статусе **Заказ поставщику** для конкретного правила, а также файла, полученного на почту, загрузка происходит при точном совпадении значений:
- Поставщик;
- Наша фирма;
- Код;
- Код-производитель;Дополнительно, если заданы в разметке:Код-производитель;
- Идентификатор клиента;
- Номер документа;
- СШ из позиции ЗК;
- Референс от клиента;
- СШ из позиции ЗП;
- Референс от поставщика.

:::

загрузка файлов в **Приходную накладную** и/или **Задание на разбор товара**;

::: note Замечание

Документ **Приходная накладная** сохраняется без проведения, документ **Задание на разбор товара** сохраняется в **Состоянии документа** заданном в **Правиле автоматического импорта**.

:::

бронирование импортируемых позиций из не проведенных документов; 

отправка уведомления о результатах автоимпорта при наличии лишних позиций или пропущенных по причине отклонения цены или сбитой разметки, а также результатах автоимпорта на почту ответственному сотруднику.

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.681.png)

![ref2]**Правила автоматического импорта** 

**Панель инструментов** позволяет осуществить над выбранными категориями ряд [действий](#370df7fa-a8cb-49ea-a363-e5760b2f112f):

![ref47] – позволяет обновить содержание табличной части. Рекомендуется использовать после внесения массовых изменений;

![ref48] Добавить – позволяет добавить новое правило автоматического импорта;

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.682.png) Сохранить – позволяет сохранить внесенные изменения в содержание табличной части;

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.683.png) Копировать – позволяет создать копию выбранного правила;

![ref51] Удалить – позволяет удалить выбранное правило;

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.684.png) Создать bat-файл – позволяет открыть окно **Создание bat-файла**;

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.685.png) – позволяет открыть выпадающий список команд **Помощь**: 

по нажатию на команду **Посмотреть видеоурок** будет открыт обучающий ролик канала Tradesoft на YouTube по работе с модулем **Автоимпорт приходных документов**;

по нажатию на команду **Открыть руководство пользователя** в окне **Руководство пользователя** будет открыт раздел **Автоимпорт приходных документов**.

![ref3]**Табличная часть**

**Табличная часть** блока настраивается индивидуально под каждого пользователя и содержит следующие колонки:

**Новые ошибки** – колонка состояния загрузки. В случае, если при загрузке произошли ошибки и в **Журнале** **импорта** есть непрочитанные сообщения о них за последние 3 дня, в колонке отображается иконка ![ref36];

**Название** – название правила автоматического импорта;

**Активность** – признак активности правила. Автоматическая загрузка **Приходных документов** происходит только по активным правилам;

**OID** – уникальный идентификатор правила в базе данных;

**Дата создания** и **Дата последнего изменения** – дата создания и последнего изменения свойств правила.

::: note Замечание

Для каждого поставщика, а также файлов разного вида и формата необходимо создавать отдельное правило на загрузку.

:::

![ref4]**Настройки**

Вкладка **Настройки** предназначена для настройки правил загрузки приходных документов с почты. Содержит группы настроек:

**Настройки подключения**:

**Активность** – позволяет установить активность каждого правила;

::: info Примечание

Автоматическая загрузка приходных документов происходит только по активным правилам.

:::

1  **Тип источника \*** – выбор типа источника, по умолчанию доступен только **Email**;
1  **Источник \*** – выбор учетной записи электронной почты, с которой будет происходить сбор приходных документов. Пример добавления учетной записи описан в разделе **Настройки электронной почты**.

**Настройки правил**:

**Электронная почта поставщика \*** – адрес электронной почты поставщика, с которого поступают письма с приходными документами;

::: note Замечание

Для того, чтобы система осуществляла поиск писем только по определенной части адреса электронной почты (например, только по домену), необходимо заменить необязательные символы в адресе на символ **\*** ("звёздочка").

:::

1  **Папка писем поставщика** – в поле указывается папка почтового сервиса, в которой будет производиться поиск писем с приходными документами от поставщика для их дальнейшей загрузки в систему. При пустом значении поля поиск писем будет выполняться в папке "Входящие". Если письма от поставщика находятся в какой-либо подпапке, необходимо указать полный путь на сервере электронной почты, начиная с корневой папки (без указания папки "Входящие"), учитывая разделители для разных почтовых серверов (вместо наименований Корневая папка, Подкаталог, Папка используйте свои названия):
   1  **Yandex**:  Корневая папка|Подкаталог|Папка писем поставщика;
   1  **GMail, Mail, Outlook**:  Корневая папка/Подкаталог/Папка писем поставщика;
   1  **Tradesoft**:  Корневая папка.Подкаталог.Папка писем поставщика.

::: warning Внимание!

Для почт Outlook и Tradesoft, если корневой папкой являются "Входящие", перед указанием пути к серверу требуется написать "INBOX" при этом папку "Входящие" указывать не нужно: INBOX/Подкаталог/Папка писем поставщика.

:::

1  **Тема письма** – тема письма от поставщика. В данном поле присутствует возможность использовать символы \* и ?, позволяющие заменить любое количество символов и один символ в теме письма, соответственно;



1  **Вложения** – наименование вложения в письме поставщика, в котором содержится приходный документ. Поле аналогично предыдущему поддерживает возможность использовать символы \* и ?;

::: warning Внимание!

Для корректной идентификации письма должны располагаться в корневой папке "Входящие" почтового ящика, поиск по подпапкам не производится.

:::

1  **Номер листа** – номер листа (таблицы), данные с которого необходимо импортировать в систему. Порядковые номера таблиц (листов) определяются в соответствии с их названиями, с сортировкой по алфавиту.

**Обработка**:

**Распаковать из ZIP-архива** - позволяет распаковать архив, если вложение является zip­архивом. Укажите название файла в архиве в поле **Файлы в архиве**, который необходимо загрузить в программу. Поле аналогично полю **Вложение** и поддерживает возможность использовать символы \* и ?;

::: warning Внимание!

Если по заданной маске будет найдено несколько вложений или файлов в архиве, все найденные файлы будут переданы в обработку.

:::

1  **Внешняя обработка** – позволяет выбрать один из файлов внешней обработки, которые представляют собой скрипты, написанные на языке VBScript. Доступны следующие обработки исходных файлов:
   1  **ConvertToCsv.vbs** – конвертация в формат .csv. Может понадобиться для корректной загрузки данных, так как формат Excel может автоматически преобразовывать некоторые значения в некорректные. Например, в ячейках могут теряться первичные нули чисел;
   1  **ConvertToXlsx.vbs** – конвертация в формат .xlsx. Может понадобиться для корректной загрузки данных в случаях, когда исходный файл с расширением .xls\* не может быть распознан системой;
   1  **UnArch.vbs** – распаковка архива. Может использоваться в случаях, когда прайс-листы присылают в архиве. Распаковка универсальная, может разархивировать любой формат;
   1  **UnArch\_and\_ConvertToCsv.vbs** и **UnArch\_and\_ConvertToXlsx.vbs** – распаковка и конвертирование. Может использоваться в случаях, когда прайс-листы необходимо извлечь из архива, а также выполнить конвертацию в один из доступных форматов.

::: note Замечание

Для использования обработчиков с распаковкой и конвертацией файлов обязательно требуется установленное на компьютере ПО 7-zip и Microsoft Excel 2007 и выше.

:::

**Настройка импорта**:

**Поставщик\*** – выберите из справочника **Поставщика**, который будет установлен в соответствующее поле в созданном документе;

**Разметка для импорта\*** – выберите разметку из сохраненных в **Мастере создания Приходных накладных**. Для выбора доступны не удаленные разметки, созданные пользователем или прочие, созданные как **Общая**;

**Наша фирма\*** – выберите из справочника **Нашу фирму**, которая будет установлена в соответствующее поле в созданном документе;

**Склад\*** – выберите из справочника склад, который будет установлен в соответствующее поле в созданном документе;

**Ответственный\*** – выберите сотрудника из списка пользователей, созданных в разделе **Управление ► Настройки программы ► Пользователи**. Выбранный сотрудник будет являться автором документа **Приходная накладная** и/или **Задания на разбор товара**. Ответственному сотруднику на указанный в карточке пользователя email будет отправляться письмо, содержащее информацию о лишних позициях по цене и/или количеству, нераспознанных позициях, а также отчет о результатах импорта каждого файла (с указанием наименования файла лога).

::: warning Внимание!

Уведомление по лишнему количеству отправляется вне зависимости от значения настройки **Действие с лишними товарами**. 

:::
::: note Замечание

Отбор **Заказов поставщику** по доступным складам, нашим фирмам и поставщикам будет определяться в соответствии с разрешенными доступами ответственного пользователя.

:::

1  **Действие с приходной накладной** – выбор действие по созданию документа **Приходная накладная**:
   1  **Не создавать** – документ **Приходная накладная** не будет создан;
   1  **Сохранить** – документ **Приходная накладная** будет создан и сохранен в программе без проведения.
      1  **Прайс-лист наличия** – позволяет выбрать прайс-лист, который будет подставлен в документ **Приходная накладная** в свойство **Прайс-лист из наличия**. Настройка доступна для пользователей с **Гибкой схемой ценообразования**, активна при выбранном значении **Сохранить** в настройке **Действие** **с приходной накладной**;
      1  **Действие с Заданием на разбор товара** – выбор действие по созданию **Задания на разбор товара**:
         1  **Не создавать** – документ **Задание на разбор товара** не будет создан;
         1  **Черновик** – документ **Задание на разбор товара** будет создан с состоянием документа: **Черновик**. В данном состоянии доступна возможность полного редактирования документа;
         1  **В очереди** – документ **Задание на разбор товара** будет создан с состоянием документа: **В очереди**. Данное состояние служит для передачи задания на склад, формируя тем самым очередь на разбор для склада/ТТ. В этом состоянии отсутствует возможность изменять документ**;**
         1  **В работе** – документ **Задание на разбор товара** будет создано с состоянием документа: **В работе**. Данное состояние отражает то, что товар из задания разбирается на складе. Ключевой особенностью задания в этом состоянии является возможность работы с документом одновременно нескольким пользователям;

::: warning Внимание!

Для успешного сохранения правила должно быть выбрано действие для создания или **Приходной накладной** и/или **Задания на разбор товара**, то есть должен быть выбран как минимум один тип документа на создание.

:::

1  **Действие с лишними товарами** – выберите действия по товарам, не найденным среди **Заказов поставщику**. Доступны значения: **добавлять в документ** и **не добавлять в документ**.

**Обслуживание** – группа настроек содержит кнопку **Управление** которая позволяет осуществить просмотр необработанных писем, соответствующих заданному правилу (адресу поставщика, теме и вложению). Откроется окно, на форме доступна ручная обработка писем: не обрабатывать или обработать повторно.

![ref5]**Журнал**

На вкладке **Журнал** по каждому правилу фиксируется дата и время этапов выполнения задачи по загрузке заказов клиентов с почты. При открытии журнала все сообщения об ошибках по выбранному правилу помечаются прочитанными.

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.686.png)

Журнал состоит из двух частей:

**Таблица с информацией о процессах и сервисной информацией**. Таблица содержит следующие колонки:

**Дата начала** и **Дата окончания** – дата и время запуска и окончания процесса автоматического импорта заказов клиентов, или дата и время изменения настроек правила, если сообщение сервисное;

**Обработка** – перечисление примененных обработок из настроек правила (блок **Обработка**). Если сообщение сервисное, то поле пустое;

**Применение** – отображается текст **Автоимпорт заказов клиентов**. Если сообщение сервисное, то поле пустое;

**Источник** – наименование источника данных из настроек правила. Если сообщение сервисное, то поле пустое;

**Компьютер** – имя компьютера, с которого был осуществлен запуск процесса автоматического импорта заказов клиентов, или имя компьютера, с которого было осуществлено изменение настроек правила, если сообщение сервисное;

**Пользователь** – логин пользователя, под которым был осуществлен запуск процесса автоматического импорта заказов клиентов, или логин пользователя, изменившего настройки правила, если сообщение сервисное;

**Итог** – результат выполнения операции. Имеет следующие значения:

![ref37] **Завершен и требует внимания** – отображается, если при импорте были выявлены нераспознанные, исключенные по количеству или стоимости позиции;

![ref36] **Ошибка** – отображается, если в таблице ниже (детализация процесса) содержится хотя бы одна запись об ошибке;

![ref38] **Успешное завершение** – отображается, если в таблице ниже (детализация процесса) содержится хотя бы одна запись об успешном завершении и не содержится ошибок;

![ref39] **Настройки изменены** – отображается для сервисных сообщений;

![ref40] **Нет данных** – состояние присваивается записи, если после выполнения любого из этапов процесса не были получены данные, подходящие под настройки правила: в источнике данных не найдены письма.

::: note Замечание

Содержит два типа сообщений:**сервисные сообщения** – информация об изменении настроек правила;
**информация о процессах** – общая информация о каждом запуске процесса автоматического импорта.

:::

**Таблица с детализацией процесса**. Таблица содержит следующие колонки:

колонка, содержащая иконку состояния процесса. Доступные значения:

![ref37]  – процесс завершен с замечаниями;

![ref36] – ошибка выполнения процесса;

![ref38] – успешное завершение выполнения процесса;

![ref41] – нет данных.

**Начало процесса** и **Окончание процесса** – дата и время запуска и окончания отдельного процесса автоматического импорта или изменения настроек правила;

**Источник файлов –** наименование источника данных из настроек правила (поле **Источник**);

**Информация об источнике –** информация об источнике (тема и дата, время письма) откуда был взят файл;

**Загруженные файлы** – наименование полученных файлов из источника данных, подходящих под настройки правила. Если в источнике данных не найдено файлов, отображается текст: "*Нет данных*". Если во время получения файлов из источника данных произошла ошибка, то отображается сообщение об ошибке;

**Файлы после обработки** – наименование обработанных файлов из источника данных, подходящих под настройки правила. Если в источнике данных не найдено файлов, отображается текст: "*Нет данных*". Если во время получения файлов из источника данных произошла ошибка, то отображается сообщение об ошибке;

**Результаты** – информация о результатах выполнения правила импорта. Если импорт завершен успешно, то отображается информация о созданном документе, датой и временем создания, а также общая информация о результатах импорта. Аналогичная информация, а также путь к файлу лога отображаются в созданном документе в поле **Комментарий**. Если в процессе импорта произошла ошибка, то отображается сообщение об ошибке. Если в источнике данных не найдено файлов, то поле пустое.

![](Aspose.Words.83ab1c44-6b28-430a-a5f2-4d9e6ba1abd4.687.png)

::: note Замечание

Содержит два типа сообщений:**сервисные сообщения** – информация об изменении настроек правила. Каждая запись содержит в себе информацию об изменении одной настройки правила;
**информация о процессах** – информация о каждом отдельном процессе общего процесса автоматического импорта.

:::