---
title: sozdanie_ispolnyaemogo_fajla_dlya_avtoimporta_s_protsenkoj
createTime: 2025/05/21 12:11:54
---
# Создание исполняемого файла для автоимпорта с проценкой

Для создания исполняемого файла автоматического запуска импорта заказов клиентов с проценкой выполните следующие действия:

**»** Предварительно создать разметку импорта для файлов от конкретного клиента.

**»** В списке заказов клиентов открыть меню команды **Импорт**, выбрать пункт **Создать bat-файл**.

![](421.png)

**»** Задать параметры подключения и настройки импорта в окне создания bat-файла.

` `![](422.png)

![](006.png)**Подключение**

Блок содержит параметры:

**Имя базы данных** – наименование** базы данных в которую будет осуществлен импорт файла;

**Логин** **–** логин учетной записи пользователя, от лица которого будет выполняться импорт;

**Пароль** **–** пароль от учетной записи пользователя, от лица которого будет выполняться импорт.

::: info Примечание

Рекомендуем создавать bat-файл от имени администратора базы данных. Bat-файл автоматически добавляется в планировщик заданий Windows, по необходимости можно скорректировать параметры автоматического запуска.

:::

![](008.png)**Настройки** 

**Действие с документом** – действие с новыми заказами: сохранять или проводить. Если выбрано значение **Создать, провести, на основании создать РН**, то после проводки заказа на все позиции "в резерве" будут созданы и сохранены **Расходные накладные**. В комментарий к расходной будет добавлен следующий текст: "*Документ создан автоматически на основании ОПИСАНИЕ\_ЗК*";

**Действие с новыми товарами** – действие над новыми товарами из файлов от клиентов;

::: info Примечание

Если в разрешениях пользователя (меню **Управление ► Настройки программы ► Роли пользователей ► Разрешения для роли пользователей ► Документы ► Заказ клиента** ► блок **Проводка**) для опции **Можно проводить с превышением долга** выставлены значения **Разрешено без штрафа, являть диалог** или **Разрешено только со штрафом, являть диалог** и в настройках bat-файла для опции **Действие с документом** задано значение **Сохранить и провести** или **Сохранить, провести, на основании создать РН**, то документ импортируется в систему, но не будет проведен, в отчете по загрузке выведется уведомление: "*Для пользователя (логин) установлено значение "(… , являть диалог)" для разрешения "Можно проводить с превышением долга". Документ сохранен, но не проведен.*", также пользователю выведется уведомление, что импорт завершен не успешно.

:::

**Путь к папке с заказами** – путь к каталогу на компьютере, в которую попадают файлы с заказами требуемого клиента. Т.е. имеет смысл под каждого клиента завести индивидуальную папку, в которую складывать файлы с заказами для импорта;

**Путь к папке с архивом** – путь к папке, в которую попадают успешно импортируемые файлы с заказами клиента;

**Путь к папке с ошибками** – путь к папке, куда попадают файлы с заказами, которые не были импортированы в программу (формат файла, превышение цен и т.д.);

**Путь к папке с логами** – путь к папке, куда попадают файлы с описанием шагов импорта по каждому файлу с заказом;

**Номер листа –** указывается номер таблиц (листа), данные с которого необходимо импортировать в систему. Порядковые номера таблиц (листов) определяются их названиями, с сортировкой по алфавиту;

**Разметка** – разметка, сохраненная ранее при импорте заказов от клиентов. Из разметки программа использует клиента, который прислал заказ;

**Диапазон записей** – диапазон строк для импорта из файла.

![](009.png)**Сохранить как** 

![](423.png)

Позволяет сохранить созданный bat-файл,  с последующим заданием его места расположения на компьютере.

**»** При запуске файла программа сканирует **Папку с заказами**, и если в ней есть файлы импортируемых форматов, то программа начинает импорт. По завершению процесса импорта будет создан новый **Заказ клиента** (меню **CRM** **► Заказы клиентов**). В случае успешного импорта, файл помещается в **Папку с архивом** (иначе – в **Папку с ошибками**). При этом все шаги процесса импорта фиксируются в **Журнал** и в лог-файл процесса импорта.

::: info Примечание

Дополнительные настройки автоматического импорта заказов клиентов из файлов расположены в разделе меню **Управление ► Настройки программы ► Настройки** в разделе **CRM ► Заказы клиентов**.Доступ к модулю **Автоимпорт заказов клиентов** регулируется разрешением **Модуль доступен** в разделе **Управление** **►** **Настройки программы ►** **Роли пользователей**, вкладка **Разрешения для роли пользователей** **►** **Автоимпорт данных ►** **Автоимпорт заказов клиентов**. По умолчанию модуль доступен для всех пользователей системы.

:::

