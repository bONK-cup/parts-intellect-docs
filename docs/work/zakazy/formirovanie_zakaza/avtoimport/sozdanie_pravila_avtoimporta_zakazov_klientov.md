---
title: sozdanie_pravila_avtoimporta_zakazov_klientov
createTime: 2025/05/21 12:14:27
---
# Создание правила автоимпорта заказов клиентов

Для создания правила загрузки заказов клиентов выполните следующий действия:

**»** В Главном меню выберите раздел **CRM** **► Автоимпорт заказов клиентов**. Откроется окно **Автоимпорта заказов клиентов**.

**»** На панели инструментов блока **Правила автоматического импорта** нажмите кнопку **Добавить** и введите название правила.

::: info Примечание

Если ранее правила не создавались, то при открытии раздела сразу будет создано правило для настройки с именем **Новое правило**.

:::

**»** Перейдите на вкладку **Настройки** для заполнения параметров правила (обязательные для заполнения поля выделены жирным шрифтом и отмечены знаком \*):

![](424.png)

![](006.png)**Добавить**

![](425.png)

Позволяет добавить новое правило автоматического импорта.

![](008.png)**Список созданных правил**

Позволяет выбрать необходимое правило из ранее созданных и сохраненных правил. 

![](009.png)**Настройки подключения**

Блок содержит следующие параметры:

**Активность** – определяет активность каждого правила;

::: info Примечание

Автоматическая загрузка заказов клиентов происходит только по активным правилам.

:::
**Тип источника \*** – выбор типа источника, по умолчанию доступен только Email;

**Источник \*** – учетная запись электронной почты, с которой будет происходить сбор заказов клиентов. 

![](010.png)**Настройки правил**

Блок содержит следующие параметры:

**Электронная почта клиента \*** – адрес электронной почты клиента, с которого поступают письма с заказами;

::: note Замечание

Для того, чтобы система осуществляла поиск писем только по определенной части адреса электронной почты (например, только по домену), необходимо заменить необязательные символы в адресе на символ \* ("звёздочка").

:::
**Папка писем клиента** – в поле указывается папка почтового сервиса, в которой будет производиться поиск писем с заказами от клиентов для их дальнейшей загрузки в систему. При пустом значении поля поиск писем будет выполняться в папке "Входящие". Если письма от клиента находятся в какой-либо подпапке, необходимо указать полный путь на сервере электронной почты, начиная с корневой папки (без указания папки "Входящие"), учитывая разделители для разных почтовых серверов (вместо наименований Корневая папка, Подкаталог, Папка – используйте свои названия):

**Yandex**:  Корневая папка|Подкаталог|Папка писем клиента;

**GMail, Mail, Outlook**:  Корневая папка/Подкаталог/Папка писем клиента;

**Tradesoft**:  Корневая папка.Подкаталог.Папка писем клиента.

::: info Примечание

Для почт Outlook и Tradesoft, если корневой папкой являются "Входящие", перед указанием пути к серверу требуется написать "INBOX" при этом папку "Входящие" указывать не нужно: INBOX/Подкаталог/Папка писем клиента.

:::

**Тема письма** – тема письма от клиента. В данном поле присутствует возможность использовать символы \* и ?, позволяющие заменить любое количество символов и один символ в теме письма, соответственно. Например:

текст "\*клиента" позволяет найти все письма, тема которых оканчивается словом "клиента";

текст "\*заказ\*" позволяет найти все письма, тема которых внутри содержит слово "заказ";

текст "Заказ\*" позволяет найти все письма, тема которых начинается со слова "Заказ";

текст "Заказ?" позволяет найти все письма, тема которых начинается со слова "Заказ" и содержит после этого слова только один символ, например, "Заказ1".

**Вложения** – наименование вложения в письме клиента, в котором содержится заказ. Поле аналогично предыдущему и поддерживает возможность использовать символы \* и ?.

::: warning Внимание!

Для корректной идентификации письма должны располагаться в корневой папке "Входящие" почтового ящика, поиск по подпапкам не производится.

:::

**Номер листа** – номер листа (таблицы), данные с которого необходимо импортировать в систему. Порядковые номера таблиц (листов) определяются в соответствии с их названиями, с сортировкой по алфавиту.

![](011.png)**Обработка**

Содержит параметры для указания какой заказ необходимо извлекать из архива, а также дополнительные обработчики:

включите опцию **Распаковать из ZIP-архива**, если вложение является zip­архивом. Укажите название файла в архиве, который необходимо загрузить в программу. Поле аналогично полю **Вложение** и поддерживает возможность использовать символы \* и ?;

::: warning Внимание!

Если по заданной маске будет найдено несколько вложений или файлов в архиве, все найденные файлы будут переданы в обработку.

:::
**Внешняя обработка** в одноименном поле присутствует возможность выбрать один из файлов внешней обработки, которые представляют собой скрипты, написанные на языке VBScript. Доступны следующие обработки исходных файлов:

**ConvertToCsv.vbs** – конвертация в формат .csv. Может понадобиться для корректной загрузки данных, так как формат Excel может автоматически преобразовывать некоторые значения в некорректные. Например, в ячейках могут теряться первичные нули чисел;

**ConvertToXlsx.vbs** – конвертация в формат .xlsx. Может понадобиться для корректной загрузки данных в случаях, когда исходный файл с расширением .xls\* не может быть распознан системой;

::: info Примечание

Для использования обработчиков с распаковкой и конвертацией файлов обязательно требуется установленное на компьютере ПО 7-zip и Microsoft Excel 2007 и выше.

:::
1  **UnArch.vbs** – распаковка архива. Может использоваться в случаях, когда прайс-листы присылают в архиве. Распаковка универсальная, может разархивировать любой формат.
1  **UnArch\_and\_ConvertToCsv.vbs** и **UnArch\_and\_ConvertToXlsx.vbs** – распаковка и конвертирование. Может использоваться в случаях, когда прайс-листы необходимо извлечь из архива, а также выполнить конвертацию в один из доступных форматов.

::: info Примечание

Для использования обработчиков с распаковкой и конвертацией файлов обязательно требуется установленное на компьютере ПО 7-zip и Microsoft Excel 2007 и выше.

:::

![](012.png)**Настройки импорта**

Блок содержит следующие параметры:

**Разметка для импорта\*** – выбор разметки из сохраненных при **Импорте** заказов клиента – **С проценкой**;

::: info Примечание

Для выбора доступны не удаленные разметки, созданные пользователем или прочие, созданные как **Общая**. Отбираются только разметки, в которых указан **Клиент**.

:::
**Клиент из разметк**и – клиент, который будет автоматически подставляться в созданный документ;

::: info Примечание

Значение **Клиента** берется со вкладки **Настройки** из разметки для импорта и редактируется только там.

:::
**Наша фирма\*** – выбор из справочника **Нашей фирмы**, которая будет установлена в соответствующее поле в созданном документе;

**Место выдачи\*** – выбор из справочника **Склада/Торговой точки**, которая будет установлена в соответствующее поле в созданном документе;

**Ответственный\*** – выбор сотрудника из списка пользователей, созданных в разделе **Управление** ► **Настройки программы**, вкладка **Пользователи**. Выбранному сотруднику на указанный в карточке пользователя email будет отправляться письмо, содержащее информацию о нераспознанных позициях, с указанием причин, по которым позиции были пропущены, а также отчет о результатах импорта каждого файла (с указанием наименования файла лога);

::: info Примечание

Ответственный будет являться автором документа **Заказ клиента**. Для корректного создания документа ответственному должны быть доступны, выбранные в правиле загрузки: **Клиент**, **Наша фирма** и **Место выдачи**.

:::
**Действие с документом** – выбор действия с найденным **Заказом клиента**: **Сохранить**/**Сохранить и провести**.

![](013.png)**Обслуживание** 

Содержит кнопку **Управление** в поле **Управление письмами** для просмотра писем, соответствующих заданному правилу (адресу почты клиента, теме и вложению). Откроется окно **Управления письмами**. Данный инструмент необходим для отладки заданных правил, чтобы убедиться, что письма находятся корректно.

![](426.png)

Включите признак **Обработать** для писем, вложения которых требуется загрузить в программу. По умолчанию признак включен у необработанных писем, вложения которых ранее не загружали. В случае включения признака у ранее обработанных писем, произойдет повторная загрузка их вложений в программу;

Отключите признак **Обработать** для писем, вложения которых не требуется загружать в программу;

Нажмите кнопку **Выбрать**. Все отмеченные письма помещаются в очередь на обработку и будут обработаны при следующем запуске bat-файла автоматического импорта;

Для отмены внесенных изменений нажмите кнопку **Отменить**.

![](014.png)**Сохранить** 

![](427.png)

Позволяет сохранить созданное или отредактированное правило.

**»** Нажмем кнопку **Сохранить** для сохранения внесенных изменений.

::: info Примечание

Для каждого клиента, а также файлов разного вида и формата необходимо создавать отдельное правило на загрузку.

:::

